EXPLOIT_FAMILIES = {

    # Electron BLADE – code execution via preload.js
    "electron_preload": {
        "impact": "Electron preload persistence",
        "families": [
            "Electron Preload Hijack",
            "ASAR Archive Injection",
            "Renderer→Main Trust Boundary Abuse"
        ],
        "cwe_classes": [
            "CWE-427",
            "CWE-22",
            "CWE-250",
            "CWE-284"
        ],
        "cve_search_tags": [
            "electron preload RCE",
            "asar archive injection",
            "electron preload path hijack"
        ],
        "killchain_role": "BLADE",
        "completion_weight": 0.35
    },

    # Electron ANCHOR – ability to write / influence preload chain via ASAR
    "preload_write": {
        "impact": "Electron preload write / ASAR control",
        "families": [
            "Electron Preload Hijack",
            "ASAR Archive Injection"
        ],
        "cwe_classes": [
            "CWE-427",
            "CWE-22",
            "CWE-250",
            "CWE-284"
        ],
        "cve_search_tags": [
            "electron asar injection",
            "electron preload hijack",
            "preload write persistence"
        ],
        "killchain_role": "ANCHOR",
        "completion_weight": 0.30
    },

    "electron_helper": {
        "impact": "Electron helper lateral execution",
        "families": [
            "Electron Helper IPC Abuse",
            "Renderer→Helper Trust Boundary Escape"
        ],
        "cwe_classes": [
            "CWE-269",
            "CWE-284",
            "CWE-862"
        ],
        "cve_search_tags": [
            "electron helper ipc exploit",
            "electron helper privilege escalation"
        ],
        "killchain_role": "BRIDGE",
        "completion_weight": 0.25
    },

    # macOS ANCHOR – LaunchAgents, LaunchDaemons, XPC, login items
    "macos_launch_persistence": {
        "impact": "macOS persistence via launchd / XPC",
        "families": [
            "LaunchAgent / LaunchDaemon injection",
            "XPC service hijack",
            "Login Item persistence"
        ],
        "cwe_classes": [
            "CWE-427",
            "CWE-732",
            "CWE-284",
            "CWE-522"
        ],
        "cve_search_tags": [
            "macos launchd persistence",
            "LaunchAgent privilege escalation",
            "XPC service CVE"
        ],
        "killchain_role": "ANCHOR",
        "completion_weight": 0.30
    },

    # Qt ANCHOR – plugin dir / rpath hijack, qt.conf
    "qt_rpath_plugin_drop": {
        "impact": "Qt plugin path control / rpath hijack",
        "families": [
            "Qt Plugin Directory Hijack",
            "qt.conf rpath injection",
            "Qt Plugin Loader Trust Boundary"
        ],
        "cwe_classes": [
            "CWE-427",
            "CWE-22",
            "CWE-426",
            "CWE-1144"
        ],
        "cve_search_tags": [
            "qt plugin hijack",
            "qt.conf rpath",
            "Qt CVE plugin"
        ],
        "killchain_role": "ANCHOR",
        "completion_weight": 0.30
    },

    # Windows ANCHOR – Run/RunOnce, Services, Scheduled Tasks, Startup, Winlogon
    "windows_persistence": {
        "impact": "Windows persistence via Run/Services/Scheduled Tasks/Startup",
        "families": [
            "Registry Run/RunOnce",
            "Scheduled Task hijack",
            "Startup folder / Winlogon",
            "Service DLL / image path"
        ],
        "cwe_classes": [
            "CWE-427",
            "CWE-732",
            "CWE-284",
            "CWE-522"
        ],
        "cve_search_tags": [
            "windows persistence",
            "scheduled task privilege escalation",
            "Run key hijack",
            "windows service CVE"
        ],
        "killchain_role": "ANCHOR",
        "completion_weight": 0.30
    },

    # .NET ANCHOR – managed code, deserialization, remoting, assembly load
    "dotnet_managed": {
        "impact": "Managed code / CLR; deserialization, remoting, assembly load surfaces",
        "families": [
            "BinaryFormatter / NetDataContractSerializer deserialization",
            ".NET Remoting",
            "Assembly.Load / LoadFrom from untrusted path",
            "Configuration (app.config / web.config) trust and remoting"
        ],
        "cwe_classes": [
            "CWE-502",
            "CWE-913",
            "CWE-20",
            "CWE-94"
        ],
        "cve_search_tags": [
            "dotnet deserialization",
            ".NET remoting RCE",
            "BinaryFormatter CVE",
            "assembly load hijack"
        ],
        "killchain_role": "ANCHOR",
        "completion_weight": 0.30
    }
}
